<!doctype html> 
<html lang="en"> 
<head> 
    <meta charset="UTF-8" />
    <title>Bashir Hilaly Assingment 7</title>
    <script src="//cdn.jsdelivr.net/npm/phaser@3.11.0/dist/phaser.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style type="text/css">
        body {
            margin: 0;
        }
    </style>
</head>
<body>

<section class="bg-gray-900 text-white">
    <div class="py-10 lg:flex lg:items-center">
        <div class="mx-auto max-w-3xl text-center">
        <h1
            class="bg-gradient-to-r from-green-300 via-blue-500 to-purple-600 bg-clip-text text-3xl font-extrabold text-transparent sm:text-5xl"
        >
            Score: <span class="text-white" id="score"></span>
        </h1>
    
    
        </div>
    </div>
</section>

<script type="text/javascript">

    // Editing score
    const renderedScore = document.getElementById("score");

    // Initialize Phaser
    var config = {
        type: Phaser.AUTO,
        width: 800,
        height: 600,
        physics: {
            default: 'arcade',
            arcade: {
                gravity: { y: 0 },
                debug: false
            }
        },
        scene: {
            preload: preload,
            create: create,
            update: update
        }
    };

    var game = new Phaser.Game(config);

    var player;
    var playerSpeed = 250;
    var stars;
    var starSpeed = 1;
    var score = 0;

    function preload() {
        this.load.image('star', 'assets/star.png');
        this.load.image('ufo', 'assets/ufo.png');
    }

    function create() {

        // Add player
        player = this.physics.add.sprite(400, 500, 'ufo').setScale(.2);
        player.setCollideWorldBounds(true);

        // Add stars group
        stars = this.physics.add.group({
            key: 'star',
            repeat: 4,
            setXY: { x: Phaser.Math.FloatBetween(5, 40), y: 0, stepX: Phaser.Math.FloatBetween(100, 250) }
        });

        // Randomize the stars y coordinates
        stars.children.iterate(function (child) {
            child.y = Phaser.Math.FloatBetween(-200, 200);
        });

        // Enable collisions
        this.physics.add.collider(stars, stars);
        this.physics.add.collider(stars, player, collectStar, null, this);

                
        // Call generateStars function every second
        this.time.addEvent({ delay: 1000, callback: generateStars, callbackScope: this, loop: true });
    }

    function update() {

        // Make the stars constantly move down
        stars.children.iterate(function (child) {
            child.y += starSpeed;

            // if they are out the frame then remove them
        })

        // Player controls
        var cursors = this.input.keyboard.createCursorKeys();

        // Keep the player stationary on the y-axis
        player.y = 550;

        if (cursors.left.isDown) {
            player.setVelocityX(-playerSpeed);
        } else if (cursors.right.isDown) {
            player.setVelocityX(playerSpeed);
        } else {
            player.setVelocityX(0);
        }

    }

    function collectStar(player, star) {
        star.disableBody(true, true);
        score += 10;
        renderedScore.innerHTML = score;
    }
    function generateStars() {
        var x = Phaser.Math.Between(0, 800);
        var star = stars.create(x, 0, 'star');
    }

</script>

</body>
</html>